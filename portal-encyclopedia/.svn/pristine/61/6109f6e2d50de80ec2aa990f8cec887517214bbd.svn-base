$(function(){LoadCatalogue()});function subLen(b,a){if(b.length>a){return b.substr(0,a)+".."}else{return b}}function LoadCatalogue(){var a=$(".canshu>h3").size();if(a>0){var b='<div class="menu"><dl><dt class="bkh">目录</dt>';var c='<div class="side_up"></div><div class="side_title">'+$("#ltName").text()+'</div><div class="side_panel" style="height:340px;"><div id="RollDiv" style="position:absolute;">';$(".canshu>h3").each(function(e){if($.trim($(this).text())==""){return true}$(this).attr("id","anchor"+e);c+='<div class="fl"><div class="fl_tit"><a href="#anchor'+e+'">'+subLen($(this).text(),9)+"</a></div>";b+="<dd ";if(e<6){b+='style="display:block;"'}b+='><a href="#anchor'+e+'">'+$(this).text()+"</a>";var d=$(this).parent().find("p>b");if(d.size()>0){b+='<ul style="display:none;">';c+='<div class="fl_cnt"><ul>';d.each(function(f){$(this).attr("id","secondAnchor"+e+"_"+f);b+='<li><a href="#secondAnchor'+e+"_"+f+'">'+$(this).text()+"</a></li>";c+='<li><a href="#secondAnchor'+e+"_"+f+'">'+subLen($(this).text(),7)+"</a></li>"});b+="</ul>";c+="</ul></div>"}c+="</div>";b+="</dd>"});b+="</dl>";if(a>6){b+='<div class="changeBtn"><span class="change">展开</span></div>';$(".menu .change").live("click",function(){if($(this).text()=="展开"){$(this).css("background-position","30px -456px");$(".menu>dl>dd>ul").show();$(".menu dl dd:gt(5)").show();$(this).text("收起")}else{$(this).css("background-position","30px -436px");$(".menu>dl>dd>ul").hide();$(".menu dl dd:gt(5)").hide();$(this).text("展开")}})}b+="</div>";c+='</div></div><div class="side_bottom"></div>';if($(".menuDiv").size()>1){$(".menuDiv").html(b)}else{$(".canshu").eq(0).before("<div class='menuDiv'>"+b+"</div>")}$(".menuDiv").height($(".menu").height());$(".movecontent").html(c);$(".side_up").mousedown(function(){CatalogueMarquee({direction:"t"})}).mouseup(function(){clearTimeout(CatalogueMarquee_setTimeout)});$(".side_bottom").mousedown(function(){CatalogueMarquee({direction:"d"})}).mouseup(function(){clearTimeout(CatalogueMarquee_setTimeout)})}else{$(".movecontent").remove()}};